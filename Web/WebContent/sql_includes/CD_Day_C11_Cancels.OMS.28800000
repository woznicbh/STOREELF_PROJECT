 with date_list as ( select /*+ parallel(8) full(all_objects)*/ TRUNC(sysdate - rownum +1) AS ord_date from   all_objects where  rownum <= 14), backorders as ( select /*+ parallel(8) full(a) full(b) full(c) full(d) */ TRUNC(a.order_date) AS ord_date, a.order_header_key, b.order_line_key, c.order_release_key, c.shipnode_key, d.order_release_status_key, d.status_quantity from   sterling.yfs_order_header a, sterling.yfs_order_line b, sterling.yfs_order_release c, sterling.yfs_order_release_status d where  a.order_header_key = b.order_header_key and    a.order_header_key = c.order_header_key and    c.order_release_key = d.order_release_key and    b.order_line_key = d.order_line_key and    a.order_header_key > TO_CHAR(SYSDATE-14,'YYYYMMDD')  and    d.status = '1400' order by d.order_release_status_key), backorders_eFC1 as ( select /*+ parallel(8) full(a)*/ a.ord_date, a.shipnode_key, sum(status_quantity) as eFC1_bo_qty from   backorders a where  shipnode_key = '873' group by a.ord_date, a.shipnode_key), backorders_eFC2 as ( select /*+ parallel(8) full(a)*/ a.ord_date, a.shipnode_key, sum(status_quantity) as eFC2_bo_qty from   backorders a where  shipnode_key = '809' group by a.ord_date, a.shipnode_key), backorders_eFC3 as ( select /*+ parallel(8) full(a)*/ a.ord_date, a.shipnode_key, sum(status_quantity) as eFC3_bo_qty from   backorders a where  shipnode_key = '819' group by a.ord_date, a.shipnode_key), backorders_eFC4 as ( select /*+ parallel(8) full(a)*/ a.ord_date, a.shipnode_key, sum(status_quantity) as eFC4_bo_qty from   backorders a where  shipnode_key = '829' group by a.ord_date, a.shipnode_key), backorders_Stores as( select /*+ parallel(8) full(a) full(b) */ a.ord_date, b.node_type, sum(status_quantity) as store_bo_qty from backorders a, sterling.yfs_ship_node b where b.node_type = 'STORE' and a.shipnode_key = b.shipnode_key group by a.ord_date,b.node_type), backorders_RDC as ( select /*+ parallel(8) full(a) full(b) */ a.ord_date, b.node_type, sum(status_quantity) as RDC_bo_qty from   backorders a, sterling.yfs_ship_node b where b.node_type = 'RDC' and a.shipnode_key = b.shipnode_key group by a.ord_date,b.node_type), resourced as ( select /*+ parallel(8) full(a) full(b) full(c) */ a.ord_date, c.shipnode_key, b.status_quantity from   backorders a, sterling.yfs_order_release_status b, sterling.yfs_order_release c where  a.order_header_key = b.order_header_key and    a.order_line_key = b.order_line_key and    a.order_release_key < b.order_release_key and    a.order_header_key = c.order_header_key and    b.order_release_key = c.order_release_key and    b.status > '3200' and    b.status <> '9000' and    b.status_quantity > 0), resourced_eFC1 as ( select /*+ parallel(8) full(a) */ a.ord_date, a.shipnode_key, sum(status_quantity) as eFC1_rs_qty from   resourced a where  shipnode_key = '873' group by a.ord_date, a.shipnode_key), resourced_eFC2 as ( select /*+ parallel(8) full(a) */ a.ord_date, a.shipnode_key, sum(status_quantity) as eFC2_rs_qty from   resourced a where  shipnode_key = '809' group by a.ord_date, a.shipnode_key), resourced_eFC3 as ( select /*+ parallel(8) full(a)*/ a.ord_date, a.shipnode_key, sum(status_quantity) as eFC3_rs_qty from   resourced a where  shipnode_key = '819' group by a.ord_date, a.shipnode_key), resourced_eFC4 as ( select /*+ parallel(8) full(a) */ a.ord_date, a.shipnode_key, sum(status_quantity) as eFC4_rs_qty from   resourced a where  shipnode_key = '829' group by a.ord_date, a.shipnode_key), resources_Stores as( select /*+ parallel(8) full(a) full(b) */ a.ord_date, b.node_type, sum(status_quantity) as store_rs_qty from  resourced a, sterling.yfs_ship_node b where b.node_type = 'STORE' and a.shipnode_key = b.shipnode_key group by a.ord_date,b.node_type), resources_RDC as( select /*+ parallel(8) full(a) full(b)*/ a.ord_date, b.node_type, sum(status_quantity) as rdc_rs_qty from  resourced a, sterling.yfs_ship_node b where b.node_type = 'RDC' and a.shipnode_key = b.shipnode_key group by a.ord_date,b.node_type), details as (SELECT /*+ parallel(8) full(a) full(b) full(c) full(d) full(e) full(f) full(g) full(h) full(i) full(j) full(k) full(l) full(m)*/ substr(to_char(a.ord_date, 'YYYY-MM-DD'),1,12) "ORDERDT", substr(NVL(e.eFC1_bo_qty,0),1,10) "EFC1CANC", substr(NVL(b.eFC1_rs_qty,0),1,10) "EFC1RSRCD", substr(NVL(f.eFC2_bo_qty,0),1,10) "EFC2CANC", substr(NVL(c.eFC2_rs_qty,0),1,10) "EFC2RSRCD", substr(NVL(g.eFC3_bo_qty,0),1,10) "EFC3CANC", substr(NVL(d.eFC3_rs_qty,0),1,10) "EFC3RSRCD", substr(NVL(i.eFC4_bo_qty,0),1,10) "EFC4CANC", substr(NVL(h.eFC4_rs_qty,0),1,10) "EFC4RSRCD", substr(NVL(j.store_bo_qty,0),1,10) "STORECANC", substr(NVL(k.store_rs_qty,0),1,10) "STORERSRCD", substr(NVL(l.RDC_bo_qty,0),1,10) "RDCCANC", substr(NVL(m.rdc_rs_qty,0),1,10) "RDCRSRCD" FROM   date_list a, resourced_eFC1 b, resourced_eFC2 c, resourced_eFC3 d, resourced_eFC4 h, backorders_eFC1 e, backorders_eFC2 f, backorders_eFC3 g, backorders_eFC4 i, resources_Stores k, backorders_Stores j, resources_RDC m, backorders_RDC l where  b.ord_date(+) = a.ord_date and    c.ord_date(+) = a.ord_date and    d.ord_date(+) = a.ord_date and    e.ord_date(+) = a.ord_date and    f.ord_date(+) = a.ord_date and    g.ord_date(+) = a.ord_date and    h.ord_date(+) = a.ord_date and    i.ord_date(+) = a.ord_date and    j.ord_date(+) = a.ord_date and    k.ord_date(+) = a.ord_date and    l.ord_date(+) = a.ord_date and    m.ord_date(+) = a.ord_date order by a.ord_date ) select /*+ parallel(8) full(details)*/ ORDERDT,EFC1CANC,EFC1RSRCD,EFC2CANC,EFC2RSRCD,EFC3CANC,EFC3RSRCD,EFC4CANC,EFC4RSRCD, STORECANC, STORERSRCD , RDCCANC, RDCRSRCD from details where ORDERDT = TO_CHAR(SYSDATE-3,'YYYY-MM-DD') 