SELECT /*+ parallel(8) full(l) */ trim(TO_CHAR(SUM(l.LINE_TOTAL),'$999,999,999,999,999.99')) AS "COUNT" FROM  YFS_ORDER_LINE l WHERE EXISTS (SELECT /*+ parallel(8) full(h) */ 'x' FROM  yfs_order_header h WHERE h.order_header_key=l.order_header_key AND h.order_date        > TRUNC(sysdate) AND h.order_date        < TRUNC(sysdate+1) AND h.enterprise_key    ='STOREELF.COM' AND h.document_type     ='0001' ) AND l.CREATEPROGID = 'JMSCreateOrderIntegServer'