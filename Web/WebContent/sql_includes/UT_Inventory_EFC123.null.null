SELECT dt.*,   dt.active+dt.case+dt.trans+dt.carton alloc_total,   dt.unalloc_case+dt.unalloc_trans unalloc_total FROM   (WITH skulist AS   (SELECT im.sku_id,     im.sku_desc,     CASE       WHEN im.convey_flag          = '1'       AND iwm.dflt_wave_proc_type <> '9'       THEN 'SORT'       WHEN im.convey_flag          = '2'       AND iwm.dflt_wave_proc_type <> '9'       THEN 'NON-SORT'       WHEN im.convey_flag         = '2'       AND iwm.dflt_wave_proc_type = '9'       THEN 'SHIP_ALONE'       WHEN im.convey_flag = '3'       THEN 'CAGE'     END AS sku_type   FROM item_master im,     item_whse_master iwm   WHERE im.sku_id = iwm.sku_id   AND im.sku_id   ='?'   ),   wmactive AS   (SELECT pld.sku_id,     SUM(pld.actl_invn_qty) AS active_inventory   FROM pick_locn_dtl pld,     locn_hdr lh   WHERE pld.locn_id  = lh.locn_id   AND lh.locn_class IN ('A', 'C')   GROUP BY pld.sku_id   ),   wmcase AS   (SELECT cd.sku_id,     SUM(actl_qty) AS case_inventory   FROM case_dtl cd,     case_hdr ch   WHERE ch.case_nbr = cd.case_nbr   AND ch.stat_code >= 10   AND ch.stat_code  < 90   AND cd.actl_qty   > 0   AND NOT EXISTS     (SELECT case_nbr     FROM case_lock cl     JOIN sys_code sc     ON sc.code_id                   = cl.invn_lock_code     AND sc.rec_type                 = 'B'     AND sc.code_type                = '527'     AND (sc.misc_flags             IS NULL     OR SUBSTR(sc.misc_flags, 2, 1) IN ('N',' '))     WHERE cl.case_nbr               = cd.case_nbr     )   GROUP BY cd.sku_id   ),   wmtrans AS   (SELECT ti.sku_id,     SUM(ti.actl_invn_units) AS trans_inventory   FROM trans_invn ti   GROUP BY ti.sku_id   ),   wmcarton AS   (SELECT sku_id,     qty_on_hand AS carton_inventory   FROM manh_mv_ctn_qty_on_hand_alloc   ),   wmunalloccase AS   (SELECT sku_id,     qty_not_alloc AS unalloccase_inventory   FROM manh_mv_case_qty_remaining   ),   wmunalloctrans AS   (SELECT ti.sku_id,     SUM(ti.actl_invn_units) AS unalloctrans_inventory   FROM trans_invn ti,     sys_code sc   WHERE ti.trans_invn_type        = sc.code_id   AND sc.rec_type                 = 'B'   AND sc.code_type                = '052'   AND (sc.misc_flags             IS NULL   OR SUBSTR(sc.misc_flags, 3, 1) IN ('N',' '))   GROUP BY ti.sku_id   ) SELECT trim(sku_id) item_id,   trim(sku_desc)  item_description,   NVL(sku_type, ' ') item_type,   COALESCE(   (SELECT active_inventory FROM wmactive WHERE sku_id = skulist.sku_id   ),0) AS ACTIVE,   COALESCE(   (SELECT case_inventory FROM wmcase WHERE sku_id = skulist.sku_id   ),0) AS   CASE,       COALESCE(       (SELECT trans_inventory FROM wmtrans WHERE sku_id = skulist.sku_id       ),0) AS TRANS,       COALESCE(       (SELECT carton_inventory FROM wmcarton WHERE sku_id = skulist.sku_id       ),0) AS CARTON,       COALESCE(       (SELECT unalloccase_inventory       FROM wmunalloccase       WHERE sku_id = skulist.sku_id       ),0) AS UNALLOC_CASE,       COALESCE(       (SELECT unalloctrans_inventory       FROM wmunalloctrans       WHERE sku_id = skulist.sku_id       ),0) AS UNALLOC_TRANS     FROM skulist     ORDER BY sku_id   ) dt 