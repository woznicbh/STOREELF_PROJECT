SELECT yfs_order_release.SALES_ORDER_NO, TO_CHAR(yfs_order_release.ORDER_DATE,'MM/DD/YYYY HH24:MI:SS') ORDER_DATE, TO_CHAR(yfs_order_release_status.modifyts,'MM/DD/YYYY HH24:MI:SS') modifyts, yfs_order_release.RELEASE_NO, yfs_order_release.SHIPNODE_KEY, yfs_order_release.EXTN_PICK_TICKET_NO AS PICKTICKET_NO, line.PRIME_LINE_NO, line.item_id, yfs_order_release_status.status_quantity, CASE st.status WHEN '1100' THEN 'Created' WHEN '1100.001' THEN 'DSV Order Shipped' WHEN '1300' THEN 'Back Ordered' WHEN '1310' THEN 'Unscheduled' WHEN '1400' THEN 'Cancelled' WHEN '1500' THEN 'Scheduled' WHEN '3200' THEN 'Released' WHEN '3200.03' THEN 'Sent To WMoS' WHEN '3350.01' THEN 'SA Sent To WMoS' WHEN '3700' THEN 'Shipped' WHEN '3700.0004' THEN 'Invoiced' WHEN '8000' THEN 'Held' WHEN '9000' THEN 'Cancelled' WHEN '9020' THEN 'Shorted' END AS STATUS, (trim(yfs_person_info.address_line1) || trim(yfs_person_info.address_line2) ||', '|| trim(yfs_person_info.city)||', '|| trim(yfs_person_info.state)||', '|| trim(yfs_person_info.zip_code)) AS SHIP_TO FROM sterling.yfs_order_release, sterling.yfs_status st, sterling.yfs_order_release_status, sterling.yfs_order_line line,sterling.yfs_person_info WHERE yfs_order_release.sales_order_no like '?%' AND yfs_order_release.extn_pick_ticket_no <> ' ' AND yfs_order_release.order_release_key = yfs_order_release_status.order_release_key AND st.status = yfs_order_release_status.status AND st.process_type_key = 'ORDER_FULFILLMENT' and yfs_order_release_status.status_quantity > 0 and line.order_line_key=yfs_order_release_status.order_line_key and yfs_order_release.ship_to_key=yfs_person_info.person_info_key UNION SELECT yfs_order_release.SALES_ORDER_NO, TO_CHAR(yfs_order_release.ORDER_DATE,'MM/DD/YYYY HH24:MI:SS') ORDER_DATE, TO_CHAR(yfs_order_release_status.modifyts,'MM/DD/YYYY HH24:MI:SS') modifyts, yfs_shipment_line.RELEASE_NO, yfs_shipment.SHIPNODE_KEY, yfs_shipment.PICKTICKET_NO, yfs_shipment_line.PRIME_LINE_NO, yfs_shipment_line.item_id, yfs_order_release_status.status_quantity, CASE st.status WHEN '1100' THEN 'Created' WHEN '1100.001' THEN 'DSV Order Shipped' WHEN '1300' THEN 'Back Ordered' WHEN '1310' THEN 'Unscheduled' WHEN '1400' THEN 'Cancelled' WHEN '1500' THEN 'Scheduled' WHEN '3200' THEN 'Released' WHEN '3200.03' THEN 'Sent To WMoS' WHEN '3350.01' THEN 'SA Sent To WMoS' WHEN '3700' THEN 'Shipped' WHEN '3700.0004' THEN 'Invoiced' WHEN '8000' THEN 'Held' WHEN '9000' THEN 'Cancelled' WHEN '9020' THEN 'Shorted' END AS STATUS, (trim(yfs_person_info.address_line1) || trim(yfs_person_info.address_line2) ||', '|| trim(yfs_person_info.city)||', '|| trim(yfs_person_info.state)||', '|| trim(yfs_person_info.zip_code)) AS SHIP_TO FROM sterling.yfs_order_release, sterling.yfs_shipment_line yfs_shipment_line, sterling.YFS_SHIPMENT, sterling.yfs_status st, sterling.yfs_order_release_status,sterling.yfs_person_info WHERE yfs_order_release.EXTN_PICK_TICKET_NO = ' ' AND yfs_order_release.ORDER_RELEASE_KEY = yfs_shipment_line.ORDER_RELEASE_KEY AND yfs_order_release.SALES_ORDER_NO like '?%' AND yfs_shipment_line.SHIPMENT_KEY = yfs_shipment.SHIPMENT_KEY AND yfs_order_release.order_release_key = yfs_order_release_status.order_release_key AND st.status = yfs_order_release_status.status AND st.process_type_key = 'ORDER_FULFILLMENT'  and yfs_order_release.ship_to_key=yfs_person_info.person_info_key and yfs_order_release_status.status_quantity > 0