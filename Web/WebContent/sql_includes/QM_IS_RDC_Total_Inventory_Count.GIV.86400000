WITH sku_count AS (SELECT /*+ parallel(8) full(i) full(s1) full(it) */ trim(TO_CHAR(COUNT(DISTINCT i.item_id),'999,999,999,999,999'))AS "COUNT" FROM  yfs_inventory_supply s1, yfs_inventory_item it, YFS_ITEM i WHERE s1.SHIPNODE_KEY IN ('865','810','840','855','830','890','885','875','860') AND it.INVENTORY_ITEM_KEY = s1.INVENTORY_ITEM_KEY AND it.ITEM_ID = i.ITEM_ID AND i.extn_dept <> ' 'AND i.extn_dept <> '0983'AND i.extn_dept <> '983'),inv_count AS (SELECT /*+ parallel(8) full(s) full(i) full(it) */  trim(TO_CHAR(SUM(s.quantity),'999,999,999,999,999')) invtotal FROM  yfs_inventory_item i,  yfs_inventory_supply s,  yfs_item it WHERE i.inventory_item_key = s.inventory_item_key AND SHIPNODE_KEY IN ('865','810','840','855','830','890','885','875','860') AND i.ITEM_ID = it.ITEM_ID AND it.EXTN_DEPT <> ' ' AND it.extn_dept <> '0983' AND it.EXTN_DEPT <> '983' ) SELECT  NVL(count,0) count, NVL(invtotal,0) invtotal FROM sku_count,inv_count