WITH c1 AS (SELECT /*+ parallel(8) full(h) full(l) full(sl) full(s) full(n) */ ROUND(AVG(AVG(s.status_date-h.order_date)),2) AS average FROM  sterling.yfs_order_header h, sterling.yfs_order_line l, sterling.yfs_shipment_line sl, sterling.yfs_shipment s, 	 sterling.yfs_ship_node n WHERE l.ORDER_HEADER_KEY = h.ORDER_HEADER_KEY   AND l.LINE_TYPE         <> 'DSV'   AND sl.ORDER_HEADER_KEY  = h.ORDER_HEADER_KEY   AND sl.shipment_key      =s.shipment_key   AND UPPER(n.NODE_TYPE) = 'STORE'    AND s.SHIPNODE_KEY = n.SHIPNODE_KEY   AND s.status       >= '1400'   AND s.status        < '9000'   AND s.status_Date        > TRUNC(sysdate) GROUP BY s.shipnode_key), c2 AS (SELECT /*+ parallel(8) full(s) full(l) full(n) */ NVL(SUM(SUM(l.quantity)),0) backlog FROM  sterling.yfs_shipment s, 	 sterling.yfs_shipment_line l, 	 sterling.yfs_ship_node n WHERE UPPER(n.NODE_TYPE) = 'STORE'    AND s.SHIPNODE_KEY = n.SHIPNODE_KEY   AND s.status        <'1400'   AND l.shipment_key  =s.shipment_key GROUP BY s.shipnode_key), c4 AS (SELECT /*+ parallel(8) full(s) full(l) full(n) */ NVL(SUM(SUM(l.quantity)),0) ttlshpunitcnt FROM  sterling.yfs_shipment s, 	 sterling.yfs_shipment_line l, 	 sterling.yfs_ship_node n WHERE UPPER(n.NODE_TYPE) = 'STORE'    AND s.SHIPNODE_KEY = n.SHIPNODE_KEY   AND s.status       >= '1400'   AND s.status        < '9000'   AND l.shipment_key  =s.shipment_key   AND s.status_date   > TRUNC(sysdate) GROUP BY s.shipnode_key), c5 AS (SELECT /*+ parallel(8) full(s) full(l) full(n) */ NVL(SUM(SUM(l.original_quantity)),0)cnclunitcnt FROM  sterling.yfs_shipment s, 	 sterling.yfs_shipment_line l, 	 sterling.yfs_ship_node n WHERE UPPER(n.NODE_TYPE) = 'STORE'    AND s.SHIPNODE_KEY = n.SHIPNODE_KEY   AND trim(s.status)  ='9000'   AND l.shipment_key  =s.shipment_key   AND s.status_date   > TRUNC(sysdate) GROUP BY s.shipnode_key), c6 AS ( Select round(c2.backlog/27000,2) expfulfill FROM c2) SELECT average,         trim(TO_CHAR(backlog,'999,999,999,999,999')) as backlog,        'N/A' pickunitcnt,        trim(TO_CHAR(ttlshpunitcnt,'999,999,999,999,999'))as ttlshpunitcnt,        trim(TO_CHAR(cnclunitcnt,'999,999,999,999,999'))as cnclunitcnt,        expfulfill FROM c1,c2,c4,c5,c6