 select  /*+ parallel(8) full(line) full(ship)*/ TRIM(TO_CHAR(NVL(sum(line.original_quantity),0),'999,999,999,999,999')) "COUNT" from sterling.yfs_shipment ship, sterling.yfs_shipment_line line where ship.shipment_key in (select /*+ parallel(8) full(yfs_shipment_status_audit))*/  shipment_key from sterling.yfs_shipment_status_audit where SHIPMENT_STATUS_AUDIT_KEY > TO_CHAR(SYSDATE , 'YYYYMMDD') and reason_code = 'System error' and new_status = '9000')  and line.shipment_key = ship.shipment_key 