SELECT dt.server_name, host_name, case when dt.server_name = 'HealthMonitor' then 'HEALTH'  else DECODE(ser.server_type,'00','INT','01','AGENT',dt.server_type) end server_type, COUNT(1) active_count FROM (SELECT DISTINCT server_name, host_name, server_type, server_id FROM yfs_heartbeat WHERE status='00' ) dt,yfs_server ser where ser.server_name(+)=dt.server_name GROUP BY dt.server_name, host_name, case when dt.server_name = 'HealthMonitor' then 'HEALTH'  else DECODE(ser.server_type,'00','INT','01','AGENT',dt.server_type) end ORDER BY host_name, server_type