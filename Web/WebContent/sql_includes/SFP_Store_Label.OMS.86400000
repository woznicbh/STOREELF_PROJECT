with REGIONS as (select r.REGION_NAME,r.region_key from STERLING.YFS_REGION r where r.REGION_SCHEMA_KEY = 'ALL_US' and r.REGION_LEVEL_NAME = 'Region' and r.region_name <> 'APOFPO' ) ,STATES as ( select r2.region_name as state,r2.REGION_KEY as stateid,r.region_key as regionid from regions r,sterling.yfs_region r2 where r2.REGION_SCHEMA_KEY = 'ALL_US' and r2.region_level_name = 'State' and r2.PARENT_REGION_KEY = r.region_key and length(trim(r2.REGION_NAME)) = 2 ) ,STORES as ( SELECT s.description || ' - ' || s.SHIPNODE_KEY as storename,s.SHIPNODE_KEY as storeid,states.stateid from sterling.yfs_ship_node s,sterling.yfs_person_info p,STATES states where s.NODE_TYPE = 'STORE' and p.PERSON_INFO_KEY = s.SHIP_NODE_ADDRESS_KEY and states.state = trim(p.STATE) ) Select r.region_key "Parent",'0' "Level",r.region_name "Location" from regions r UNION Select s.stateid,s.regionid,s.state from states s UNION Select st.storeid,st.stateid,st.storename from stores st