WITH item_dt AS (SELECT * FROM yfs_item WHERE item_id = '?'),      item_inv_dt      AS (SELECT invit.inventory_item_key,                 item.item_id,                 item.short_description            FROM yfs_inventory_item invit, item_dt item           WHERE invit.item_id = item.item_id),      sup_dt      AS (SELECT i_sup.*            FROM yfs_inventory_supply i_sup, yfs_ship_node ship           WHERE     i_sup.supply_type = 'ONHAND'                 AND i_sup.shipnode_key = ship.shipnode_key                 AND ship.node_type != 'STORE'),      dem_dt      AS (SELECT i_dmd.*            FROM yfs_inventory_demand i_dmd, yfs_ship_node ship           WHERE (i_dmd.demand_type = 'ALLOCATED'                  OR i_dmd.demand_type = 'RESERVED')                 AND i_dmd.shipnode_key = ship.shipnode_key                 AND ship.node_type != 'STORE'), supply AS (                 SELECT i.ITEM_ID,        i.SHORT_DESCRIPTION,        'SUPPLY' AS INV_TYPE,        DECODE (TRIM (s.shipnode_key),'855', 'RDC - 855','885', 'RDC - 885','810', 'RDC - 810','830', 'RDC - 830','840', 'RDC - 840','860', 'RDC - 860','865', 'RDC - 865','875', 'RDC - 875','890', 'RDC - 890','873', 'EFC 1-873','809', 'EFC 2-809','829', 'EFC 4-829','819', 'EFC 3-819',NULL, ' ',TRIM (s.shipnode_key))           SHIPNODE_KEY,        NVL (SUM (s.QUANTITY), '0.0') AS QUANTITY   FROM sup_dt s, item_inv_dt i  WHERE i.inventory_item_key = s.INVENTORY_ITEM_KEY(+) GROUP BY i.ITEM_ID,          i.SHORT_DESCRIPTION,          'SUPPLY',          DECODE (TRIM (s.shipnode_key),                  '855', 'RDC - 855',                  '885', 'RDC - 885',                  '810', 'RDC - 810',                  '830', 'RDC - 830',                  '840', 'RDC - 840',                  '860', 'RDC - 860',                  '865', 'RDC - 865',                  '875', 'RDC - 875',                  '890', 'RDC - 890',                  '873', 'EFC 1-873',                  '809', 'EFC 2-809',                  '829', 'EFC 4-829',                  '819', 'EFC 3-819',                  NULL, ' ',                  TRIM (s.shipnode_key))), demand AS (                  SELECT i.ITEM_ID,        i.SHORT_DESCRIPTION,        'DEMAND' AS INV_TYPE,        DECODE (TRIM (s.shipnode_key),                '855', 'RDC - 855',                '885', 'RDC - 885',                '810', 'RDC - 810',                '830', 'RDC - 830',                '840', 'RDC - 840',                '860', 'RDC - 860',                '865', 'RDC - 865',                '875', 'RDC - 875',                '890', 'RDC - 890',                '873', 'EFC 1-873',                '809', 'EFC 2-809',                '829', 'EFC 4-829',                '819', 'EFC 3-819',                NULL, ' ',                TRIM (s.shipnode_key))           SHIPNODE_KEY,        NVL (SUM (s.QUANTITY), '0.0') AS QUANTITY   FROM dem_dt s, item_inv_dt i  WHERE i.inventory_item_key = s.INVENTORY_ITEM_KEY(+) GROUP BY i.ITEM_ID,          i.SHORT_DESCRIPTION,          'DEMAND',          DECODE (TRIM (s.shipnode_key),                  '855', 'RDC - 855',                  '885', 'RDC - 885',                  '810', 'RDC - 810',                  '830', 'RDC - 830',                  '840', 'RDC - 840',                  '860', 'RDC - 860',                  '865', 'RDC - 865',                  '875', 'RDC - 875',                  '890', 'RDC - 890',                  '873', 'EFC 1-873',                  '809', 'EFC 2-809',                  '829', 'EFC 4-829',                  '819', 'EFC 3-819',                  NULL, ' ',                  TRIM (s.shipnode_key))                  ) select supply.ITEM_ID, supply.SHORT_DESCRIPTION, supply.SHIPNODE_KEY, supply.QUANTITY as SUPPLY, NVL(demand.QUANTITY,0) as DEMAND from supply LEFT JOIN demand on supply.SHIPNODE_KEY = demand.SHIPNODE_KEY