WITH sku_count AS (SELECT /*+ parallel(8) full(s) */ trim(TO_CHAR(COUNT(s.INVENTORY_ITEM_KEY),'999,999,999,999,999')) AS "COUNT" FROM  YFS_INVENTORY_SUPPLY s WHERE LENGTH(trim(s.SHIPNODE_KEY)) > 3 and s.quantity >0), inv_count AS (SELECT /*+ parallel(8) full(i) full(s) full(it) */ trim(TO_CHAR(SUM(s.quantity),'999,999,999,999,999')) invtotal FROM  yfs_inventory_item i,  yfs_inventory_supply s,  yfs_item it WHERE i.inventory_item_key = s.inventory_item_key AND LENGTH(trim(s.SHIPNODE_KEY)) > 3 AND i.ITEM_ID = it.ITEM_ID AND it.EXTN_DEPT <> ' ' AND it.extn_dept <> '0983' AND it.EXTN_DEPT <> '983' and s.quantity >0) SELECT  sku_count.*, NVL(invtotal,0) invtotal FROM sku_count,inv_count