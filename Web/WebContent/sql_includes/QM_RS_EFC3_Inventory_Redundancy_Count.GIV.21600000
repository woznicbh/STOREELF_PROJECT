WITH UNIQUE_SKU_COUNT AS (select /*+ parallel(8) full(s1) full(it) full(i)*/ count(distinct i.item_id) uniquecount from  yfs_inventory_supply s1, yfs_inventory_item it, YFS_ITEM i  where s1.SHIPNODE_KEY = '819'  and it.INVENTORY_ITEM_KEY = s1.INVENTORY_ITEM_KEY  and it.ITEM_ID = i.ITEM_ID  and i.extn_dept <> ' '  and i.extn_dept <> '0983'  and i.extn_dept <> '983'  and not exists (select /*+ parallel(8) full(s2)*/ 'x' from  yfs_inventory_supply s2  where s2.INVENTORY_ITEM_KEY = s1.INVENTORY_ITEM_KEY  and s2.SHIPNODE_KEY in ('873','809','829','865','810','840','855','830','890','885','875','860','879','859','889','869'))  ),TOTAL_SKU_COUNT AS (SELECT /*+ parallel(8) full(s)*/ COUNT(s.INVENTORY_ITEM_KEY) AS totalcount FROM  YFS_INVENTORY_SUPPLY s WHERE s.SHIPNODE_KEY ='819') SELECT trim(TO_CHAR(uniquecount,'999,999,999,999,999')),decode(totalcount, 0, '0',ROUND((uniquecount/totalcount)*100,0)) FROM UNIQUE_SKU_COUNT,TOTAL_SKU_COUNT